<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TVA SQN Copilot Companion</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, sans-serif;
      background-color: #f4f7fb;
      color: #003366;
    }
    .container {
      display: flex;
      min-height: 100vh;
    }
    /* Sidebar */
    .sidebar {
      width: 230px;
      background: linear-gradient(180deg, #002b5c, #004080);
      color: white;
      padding: 20px;
      box-sizing: border-box;
    }
    .sidebar h2 {
      font-size: 20px;
      margin-bottom: 30px;
      text-align: center;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      padding-bottom: 10px;
    }
    .nav-item {
      padding: 12px 15px;
      margin-bottom: 8px;
      cursor: pointer;
      border-radius: 6px;
      display: block;
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: background 0.3s;
    }
    .nav-item:hover {
      background: rgba(255,255,255,0.15);
    }
    .active {
      background: rgba(255,255,255,0.25);
    }
    /* Main content */
    .main {
      flex: 1;
      padding: 30px;
      box-sizing: border-box;
    }
    /* Banner */
    .banner {
      background: url("/static/images/sqn2.jpg") center/cover no-repeat;
      height: 150px;
      border-radius: 8px;
      position: relative;
      margin-bottom: 20px;
    }
    .banner::after {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 43, 92, 0.5);
      border-radius: 8px;
    }
    /* Disclaimer */
    .disclaimer {
      background: #fff8e1;
      border-left: 6px solid #ff9800;
      padding: 15px 20px;
      border-radius: 6px;
      font-size: 14px;
      margin-bottom: 20px;
    }
    /* About Section */
    .about {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-bottom: 25px;
    }
    .about h2 {
      margin-top: 0;
      color: #002b5c;
    }
    /* Form */
    .form-section {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-bottom: 25px;
    }
    label {
      font-weight: 500;
      display: block;
      margin-bottom: 5px;
    }
    select, textarea, input[type="text"], button {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    button {
      background: #004080;
      color: white;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }
    button:hover {
      background: #002b5c;
    }
    /* Follow-up Questions */
    .followup-section {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-top: 25px;
      display: none;
    }
    .followup-section h3 {
      margin-top: 0;
      color: #004080;
    }
    .followup-question {
      margin-bottom: 15px;
    }
    .not-sure-btn {
      display: inline-block;
      margin-left: 10px;
      background-color: #ff9800;
      color: white;
      border: none;
      padding: 6px 10px;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
    }
    .not-sure-btn:hover {
      background-color: #e68a00;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <h2>üìò SQN Copilot</h2>
      <a href="/" class="nav-item active">üè† Home</a>
      <a href="/teach_me" class="nav-item">üìö Teach Me</a>
      <a href="/troubleshooter" class="nav-item">üõ† Troubleshooter</a>
      <a href="/logout" class="nav-item">üö™ Logout</a>
    </div>
    <div class="main">
      <div class="banner"></div>

      <div class="disclaimer">
        <strong>‚ö†Ô∏è TVA Use & Safety Notice:</strong> Do not enter or upload TVA-sensitive, personal, or confidential information. This tool uses AI to provide guidance, step-by-step instructions, and troubleshooting for Microsoft 365. It is intended for learning, productivity, and general workplace support in compliance with TVA security policies.
      </div>

      <div class="about">
        <h2>About This Tool</h2>
        <p>The SQN Copilot Companion is designed to help TVA employees get the most out of Microsoft 365. It uses AI to give clear, step-by-step instructions and create high-quality Copilot prompts that save time and reduce frustration. Whether you need to create a polished document in Word, organize data in Excel, manage email in Outlook, collaborate in Teams, or design a presentation in PowerPoint ‚Äî this tool is here to assist you every step of the way.</p>
        <p>Simply choose your Microsoft 365 app, describe your task or issue, and let the AI guide you with tailored prompts or manual instructions. This ensures you can complete tasks quickly, accurately, and with confidence.</p>
      </div>

      <div class="form-section">
        <form id="main-form">
          <label for="app">Choose your Microsoft 365 app:</label>
          <select id="app" name="app" required>
            <option value="">Select an app</option>
            <option>Word</option>
            <option>Excel</option>
            <option>Outlook</option>
            <option>Teams</option>
            <option>PowerPoint</option>
          </select>

          <label for="goal">Describe your goal or issue:</label>
          <textarea id="goal" name="goal" rows="3" placeholder="Describe what you want to do or the problem you're facing..."></textarea>

          <button type="submit">Generate Copilot Prompt</button>
        </form>
      </div>

      <div id="followup" class="followup-section">
        <h3>Follow-up Questions</h3>
        <p>To assist you better, please answer the following:</p>
        <form id="followup-form">
          <div id="followup-questions"></div>
          <button type="submit">Submit Answers</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    document.getElementById("main-form").addEventListener("submit", function(e) {
      e.preventDefault();
      // Simulate getting questions from backend
      const questions = [
        "What is the exact version of Microsoft Word you are using?",
        "Can you describe the document layout you want?",
        "Do you want changes applied to the whole document or only certain sections?"
      ];
      renderFollowupQuestions(questions);
      document.getElementById("followup").style.display = "block";
      document.getElementById("followup").scrollIntoView({ behavior: "smooth" });
    });

    function renderFollowupQuestions(questions) {
      const container = document.getElementById("followup-questions");
      container.innerHTML = "";
      questions.forEach((q, index) => {
        const wrapper = document.createElement("div");
        wrapper.className = "followup-question";

        const label = document.createElement("label");
        label.textContent = q;

        const input = document.createElement("input");
        input.type = "text";
        input.name = `q${index}`;
        input.style.width = "80%";

        const btn = document.createElement("button");
        btn.type = "button";
        btn.textContent = "I'm Not Sure";
        btn.className = "not-sure-btn";
        btn.onclick = async () => {
          try {
            const res = await fetch(`/explain_question?index=${index}`);
            const data = await res.json();
            alert(`Tip: ${data.explanation}`);
          } catch (err) {
            alert("Error getting explanation.");
          }
        };

        wrapper.appendChild(label);
        wrapper.appendChild(input);
        wrapper.appendChild(btn);
        container.appendChild(wrapper);
      });
    }
  </script>
</body>
</html>
