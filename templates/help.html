<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SQN Copilot Companion • Help Desk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style_classic.css') }}">
</head>
<body>
  <div class="disclaimer" role="note">
    ⚠️ Do not input or share TVA-sensitive, personal, or confidential information. Use general descriptions only.
  </div>

  <div class="header">
    <div class="header-content">
      <img src="/static/images/tva_logo.png" alt="TVA Logo" />
      <div class="title">Help Desk</div>
      <div class="subtitle">Type your question. Get simple, step‑by‑step help.</div>
    </div>
  </div>

  <div class="container" role="main">
    <div class="panel" style="margin-top:0" aria-labelledby="start-here">
      <b id="start-here">Start here</b>
      <div style="margin-top:8px; line-height:1.6">
        1) Type your question in plain language (what you want to do or what’s broken).<br>
        2) Keep it general. Do not include private data.<br>
        3) Click <b>Get Help</b> to see numbered steps in a “for dummies” tone.<br>
        Tip: Click an example to prefill the box.
      </div>
    </div>

    <h2 style="margin-top:18px">Examples (click to fill)</h2>
    <div class="badges" aria-label="example questions">
      <button class="btn-soft" type="button" onclick="fill('How do I search for the word &quot;help&quot; in a Word document?')">Word • Find a word</button>
      <button class="btn-soft" type="button" onclick="fill('Excel shows #N/A in VLOOKUP for some names. How do I fix it?')">Excel • VLOOKUP #N/A</button>
      <button class="btn-soft" type="button" onclick="fill('How do I schedule a recurring weekly Teams meeting with a custom time zone?')">Teams • Recurring meeting</button>
      <button class="btn-soft" type="button" onclick="fill('Outlook won’t send. Messages are stuck in Outbox. How do I fix it?')">Outlook • Stuck Outbox</button>
      <button class="btn-soft" type="button" onclick="fill('Turn bullet notes into a clean slide outline in PowerPoint.')">PowerPoint • Slide outline</button>
    </div>

    <h1 style="margin-top:10px">Ask anything about Microsoft 365</h1>
    <p class="lead">Example: “How do I search for the word ‘help’ in a Word document?”</p>

    <form method="post" autocomplete="off" onsubmit="return onSubmit()" aria-describedby="hint">
      <label class="label" for="user_question">Describe your issue or question (Word, Excel, Outlook, Teams, PowerPoint)</label>
      <textarea
        id="user_question"
        name="user_question"
        placeholder="Type your question in plain language. Example: In Word, I need to find every place the word help appears."
        aria-required="true"
        aria-describedby="hint counter"
        autofocus
      >{{ user_question }}</textarea>

      <div class="hint" id="hint">Write 8–20 words so we can give precise steps. Do not paste sensitive info.</div>
      <div class="hint" id="counter">0 characters</div>

      <div style="margin-top:10px; display:flex; gap:8px; align-items:center">
        <button id="submitBtn" class="button" type="submit" disabled>Get Help</button>
        <a class="btn-soft" href="{{ url_for('home') }}">Back to Home</a>
      </div>
    </form>

    <h2 style="margin-top:22px">Answer</h2>
    {% if answer %}
      <div class="panel mono" id="answerBox">{{ answer|safe }}</div>
    {% else %}
      <div class="panel" id="answerPlaceholder">Your beginner‑friendly steps will appear here after you click <b>Get Help</b>.</div>
    {% endif %}

    <hr class="divider" />
    <div class="footer">SQN Copilot Companion • TVA-safe guidance for Microsoft 365</div>
  </div>

  <script>
    const ta = document.getElementById('user_question');
    const counter = document.getElementById('counter');
    const submitBtn = document.getElementById('submitBtn');

    function updateCounter(){
      const len = (ta.value || '').trim().length;
      counter.textContent = len + ' characters';
      submitBtn.disabled = len < 12; // require a bit of detail
    }
    function fill(text){
      ta.value = text;
      updateCounter();
      ta.focus();
      window.scrollTo({ top: ta.getBoundingClientRect().top + window.scrollY - 120, behavior: 'smooth' });
    }
    function onSubmit(){
      submitBtn.textContent = 'Working...';
      submitBtn.disabled = true;
      return true;
    }
    ta && ta.addEventListener('input', updateCounter);
    updateCounter();
  </script>
</body>
</html>
