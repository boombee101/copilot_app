<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help & Support - TVA Copilot Companion</title>
    <style>
        body {
            font-family: "Segoe UI", Tahoma, sans-serif;
            margin: 0;
            background-color: #f0f4f9;
            color: #003366;
        }
        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 220px;
            height: 100%;
            background-color: #002855;
            padding-top: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .sidebar a {
            color: white;
            padding: 12px;
            text-decoration: none;
            display: flex;
            align-items: center;
            width: 100%;
            justify-content: flex-start;
            gap: 10px;
            transition: background 0.3s;
        }
        .sidebar a:hover {
            background-color: #004080;
        }
        .sidebar a.active {
            background-color: #0055a5;
        }
        /* Main Content */
        .main {
            margin-left: 240px;
            padding: 20px;
        }
        h1 {
            font-size: 26px;
            margin-bottom: 10px;
        }
        .help-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        textarea, input[type="text"], select {
            width: 100%;
            padding: 10px;
            margin-top: 6px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-family: inherit;
        }
        button {
            background-color: #0055a5;
            color: white;
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #003f7d;
        }
        /* Steps styling (same as ask_help) */
        .steps { display: grid; gap: 12px; margin-top: 12px; }
        .step { background:#f7fbff; border:1px solid #c9d8ea; border-radius:10px; padding:12px 12px 12px 48px; position:relative; line-height:1.5; }
        .step-num { position:absolute; left:12px; top:12px; width:28px; height:28px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-weight:700; background:#004785; color:#fff; }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 30px;
            font-size: 13px;
            color: #666;
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar">
        <a href="{{ url_for('home') }}">
            üè† Home
        </a>
        <a href="{{ url_for('teach_me') }}">
            üìò Teach Me
        </a>
        <a href="{{ url_for('troubleshooter') }}">
            üõ†Ô∏è Troubleshooter
        </a>
        <a href="{{ url_for('prompt_builder') }}">
            ‚úèÔ∏è Prompt Builder
        </a>
        <a href="{{ url_for('help') }}" class="active">
            ‚ùì Help
        </a>
        <a href="{{ url_for('logout') }}">
            üö™ Logout
        </a>
    </div>

    <!-- Main Content -->
    <div class="main">
        <h1>Help & Support</h1>
        
        <div class="help-section">
            <h2>About This Page</h2>
            <p>
                This Help page is here to assist you in using the TVA Copilot Companion effectively.  
                You can find answers to common questions, learn how to navigate features, and even ask AI for quick guidance.
            </p>
            <ul>
                <li><strong>Teach Me:</strong> Learn Microsoft 365 tools in a beginner-friendly way with step-by-step instructions.</li>
                <li><strong>Troubleshooter:</strong> Paste in an error message or describe an issue to get a plain-language fix.</li>
                <li><strong>Prompt Builder:</strong> Describe your goal, and AI will create a ready-to-use Copilot prompt.</li>
            </ul>
        </div>

        <div class="help-section">
            <h2>Ask AI for Quick Help</h2>
            <form method="POST" action="{{ url_for('ask_help') }}">
                <label for="app">Which app are you using?</label>
                <select id="app" name="app" required>
                    <option value="Word">Word</option>
                    <option value="Excel">Excel</option>
                    <option value="Outlook">Outlook</option>
                    <option value="Teams">Teams</option>
                    <option value="PowerPoint">PowerPoint</option>
                </select>

                <label for="problem">Describe your problem:</label>
                <textarea name="problem" id="problem"
                          placeholder="Example: My Word document won‚Äôt save to OneDrive."
                          required></textarea>

                <button type="submit">Get AI Help</button>
            </form>
        </div>

        {% if result %}
        <div class="help-section">
            <h2>AI Response:</h2>
            <div class="steps">
              {% for line in result.split('\n') if line.strip() %}
                <div class="step">
                  <div class="step-num">{{ loop.index }}</div>
                  {{ line }}
                </div>
              {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Footer -->
    <footer>
        TVA Copilot Companion ‚Äî Powered by AI for Microsoft 365
    </footer>

</body>
</html>
